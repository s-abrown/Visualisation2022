<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTJ4</title>

    <button id="btnElp">El-p</button>
    <button id="btnKM">Killer Mike</button>


    <style>
        svg {
            background-color: whitesmoke;
            margin: 1px solid;
        }

        div.tooltip {	
            position: absolute;			
            text-align: center;			
            width: 60px;					
            height: 28px;					
            padding: 2px;				
            font: 12px sans-serif;		
            background: lightsteelblue;	
            border: 0px;		
            border-radius: 8px;			
            pointer-events: none;			
        }

    </style>
</head>
<body>

    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>

    <script>
      
        // WINDOW SIZE AND MARGINS

        //const width = window.innerWidth;
        //const height = window.innerHeight;

        const margin = {top: 20, right: 10, bottom: 20, left: 10};
        const width = innerWidth - margin.left - margin.right,
              height = window.innerHeight - margin.top - margin.bottom;

       /*  const g = d3.select("body").append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); */


        // LINKING THE CSV FILE TO THE DOCUMENT
        d3.csv('RTJ4.csv', function(d) {
            return {
                speaker : d.speaker,
                boasting : +d.mentionBoasting,
                killerMike : +d.mentionKillerMike,
                elP : +d.mentionElP,
                family : +d.mentionFamily,
                disillusion : +d.mentionDisillusion,
                threatening : +d.mentionThreatening,
                anguish : +d.mentionAnguish,
                existentialism : +d.mentionExistentialism,
                poverty : +d.mentionPoverty,
                education : +d.mentionEducation,
                wealth : +d.mentionWealth,
                work : +d.mentionWork,
                crime : +d.mentionCrime,
                elections : +d.mentionElections,
                slavery : +d.mentionSlavery,
                racism : +d.mentionRacism,
                revolution : +d.mentionRevolution,
                antiReligion : +d.mentionAntiReligion,
                authority : +d.mentionAuthority,
                antiCapitalism : +d.mentionAntiCapitalism,
                antiPolice : +d.mentionAntiPolice,
                money : +d.mentionMoney,
                car : +d.mentionCar, 
                weapon : +d.mentionWeapon,
                socialMedia : +d.mentionSocialMedia,
                person : +d.mentionKillerMike + +d.mentionElP + +d.mentionFamily + +d.mentionOsamaBL + +d.mentionMohammedAli + +d.mentionKurtVonnegut + +d.mentionAynRand + +d.mentionDonaldTrump + +d.mentionToussainLouverture + +d.mentionNapoleonBonaparte + +d.mentionMalcolmX + +d.mentionMLK + +d.mentionJimmySavile + +d.mentionNoamChomsky + +d.mentionCharlesBukowski + +d.mentionDickGregory,
                feeling : +d.mentionBoasting + +d.mentionDisillusion + +d.mentionThreatening + +d.mentionAnguish + +d.mentionExistentialism,
                place : +d.mentonBrooklyn + +d.mentionNewYork + +d.mentionMiami + +d.mentionAtlanta + +d.mentionGuantanamo,
                state : +d.mentionPoverty + +d.mentionEducation + +d.mentionWealth,
                object : +d.mentionCar + +d.mentionMoney + +d.mentionWeapon + +d.mentionSocialMedia,
                action : +d.mentionWork + +d.mentionCrime,
                substanceUse : +d.mentionDrugs + +d.mentionAlcohol + +d.mentionTobacco,
                trackNumber : +d.trackNumber,

            }
            // Possible place to add categories together to do an overall heatmap (for both speakers)?
        }).then(data => {
          let canvas1 = d3.select('body')
                .append('svg')
                //.attr('width', width - 40)
                .attr("width", width + margin.left + margin.right)
                //.attr('height', height - 40)
                .attr("height", height + margin.top + margin.bottom)
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")")

          // .data(data.filter(function(d){ 
          //  return d.speaker == "killerMike" }))



          // LABELS FOR THE X AND Y AXES
          let myGroups = ["Song 1", "Song 2", "Song 3", "Song 4", "Song 5", "Song 6", "Song 7", "Song 8", "Song 9", "Song 10", "Song 11"]
          let myVars = ["Killer Mike", "El-P", "family", "boasting", "disillusion", "threatening", "anguish", "existentialism", "anti-capitalism", "anti-police", "authority", "slavery", "racism", "elections", "revolution", "anti-religion", "poverty", "education", "wealth", "car", "money", "weapon", "social-media ", "work", "crime", "substances"]

          // Build X scales and axis:
          /* let x = d3.scalePoint()
            .range([ 115, 890 ])
            .domain(myVars)
          canvas1.append("g")
            .attr("transform", 'translate(0, 390)')
            .call(d3.axisBottom(x))
            .selectAll("text")
              .attr("transform", "translate(-10,10)rotate(-45)")
              .style("text-anchor", "end")
              .style("font-size", 20)
              .style("fill", "#e81ce8") */

            // X AXIS AND SCALE
            let xScale = d3.scaleLinear()
               .domain([1, 25])
               .range([115, 884])
            
            let xAxisGenerator = d3.axisBottom(xScale);
            xAxisGenerator.ticks(25)
            xAxisGenerator.tickFormat((d,i) => myVars[i]);

            let xAxis = canvas1.append("g")
            .call(xAxisGenerator)
            .attr("transform", 'translate(0, 390)')
            .selectAll("text")
              .attr("transform", "translate(-10,2)rotate(-45)")
              .style("text-anchor", "end")
              .style("font-size", 10)
              .style("fill", "#e81ce8")
              //.attr("transform",`translate(${0},${height - 20})`);


            // Y AXIS AND SCALE
            let yScale = d3.scaleLinear()
               .domain([1, 11])
               .range([50, 370])
            
            let yAxisGenerator = d3.axisLeft(yScale);
            yAxisGenerator.ticks(11)
            yAxisGenerator.tickFormat((d,i) => myGroups[i]);

            let yAxis = canvas1.append("g")
            .call(yAxisGenerator)
            .attr("transform", 'translate(90, 0)')
            .selectAll("text")
              .style("font-size", 10)
              .style("fill", "#e81ce8")

          // Build Y scales and axis:/* 
         /*  let y = d3.scalePoint()
            .range([ height, 0 ])
            .domain(data.map(d => d.trackNumber))            
            .padding(0.01);
          canvas1.append("g")
            .call(d3.axisLeft(y));  */

          // COLOUR SCALE FOR THE SQUARES
          let myColour = d3.scaleLinear()
            .range(["#f2b8ec", "#cc006d"])
            .domain([0, 15])

          // // CREATING A HIGHLIGHTER/ TOOLTIP TO HOVER OVER EACH SQUARE VERSION 1
          // let tooltip = d3.select("canvas1")
          //   .append("div")
          //   .style("opacity", 0)
          //   .attr("class", "tooltip")
          //   .style("background-color", "white")
          //   .style("border", "solid")
          //   .style("border-width", "2px")
          //   .style("border-radius", "5px")
          //   .style("padding", "5px")

          // // THREE FUNCTIONS TO SHOW THE READER INFO WHEN HOVERING OVER A SQUARE
          // let mouseover = function(d) {
          //   tooltip.style("opacity", 1)
          // }
          // let mousemove = function(d) {
          //   tooltip
          //     .html("The exact value of<br>this cell is: " + d.value)
          //     .style("left", (d3.pointer(this)[0]+70) + "px")
          //     .style("top", (d3.pointer(this)[1]) + "px")
          // }
          // let mouseleave = function(d) {
          //   tooltip.style("opacity", 0)
          // }

          


        // TOOLTIP ATTEMPT NUMBER 2
        let div = d3.select("body").append("div")	
          .attr("class", "tooltip")				
          .style("opacity", 0);

          // ADDING THE SQUARES
        function feedingData(therightdata){
          for(let i=0 ; i< 25 ; i++){
            canvas1.selectAll()
              .data(data.filter(function(d){
                return d.speaker == therightdata }))
              .enter()
              .append("rect")
                .attr("x", 100 + (i * 32))
                .attr("y", d => d.trackNumber * (32))
                .attr("width", 30)
                .attr("height", 30)
                .style("fill", d => {
                  // mention Killer Mike
                  if(i == 0){
                     return myColour(+d.killerMike)
                  }
                  // mention El-P
                  else if (i == 1){
                    return myColour(+d.elP)
                  }
                  // mention Family
                  else if (i == 2){
                    return myColour(+d.family)
                  }
                  // mention boasting
                  else if (i == 3){
                    return myColour(+d.boasting)
                  }
                  // mention disillusion
                  else if (i == 4){
                    return myColour(+d.disillusion)
                  }
                  // mention threatening
                  else if (i == 5){
                    return myColour(+d.threatening)
                  }
                  // mention anguish
                  else if (i == 6){
                    return myColour(+d.anguish)
                  }
                  // mention existentialism
                  else if (i == 7){
                    return myColour(+d.existentialism)
                  }
                  // mention anti-capitalism
                  else if (i == 8){
                    return myColour(+d.antiCapitalism)
                  }
                  // mention anti-police
                  else if (i == 9){
                    return myColour(+d.antiPolice)
                  }
                  // mention authority
                  else if (i == 10){
                    return myColour(+d.authority)
                  }
                  // mention slavery
                  else if (i == 11){
                    return myColour(+d.slavery)
                  }
                  // mention racism
                  else if (i == 12){
                    return myColour(+d.racism)
                  }
                  // mention elections
                  else if (i == 13){
                    return myColour(+d.elections)
                  }
                  // mention revolution
                  else if (i == 14){
                    return myColour(+d.revolution)
                  }
                  // mention anti-religion
                  else if (i == 15){
                    return myColour(+d.antiReligion)
                  }
                  // mention poverty
                  else if (i == 16){
                    return myColour(+d.poverty)
                  }
                  // mention education
                  else if (i == 17){
                    return myColour(+d.education)
                  }
                  // mention wealth
                  else if (i == 18){
                    return myColour(+d.wealth)
                  }
                  // mention car
                  else if (i == 19){
                    return myColour(+d.car)
                  }
                  // mention money
                  else if (i == 20){
                    return myColour(+d.money)
                  }
                  // mention weapon
                  else if (i == 21){
                    return myColour(+d.weapon)
                  }
                  // mention social-media 
                  else if (i == 22){
                    return myColour(+d.socialMedia)
                  }
                  // mention work
                  else if (i == 23){
                    return myColour(+d.work)
                  }
                  // mention crime
                  else if (i == 24){
                    return myColour(+d.crime)
                  }
                  // mention substances
                  else if (i == 25){
                    return myColour(+d.substanceUse)
                  }
                })

              feedingData("el-p")

              document.getElementById('btnElp')
                .addEventListener('click', function(e){
                  e.preventDefault();
                  therightdata("el-p")
              })

              document.getElementById('btnKM')
                .addEventListener('click', function(e){
                  e.preventDefault();
                  therightdata("killerMike")
              })
                // TOOLTIP INTERACTION OPTION 1
                //.on("mouseover", mouseover)
                //.on("mousemove", mousemove)
                //.on("mouseleave", mouseleave)
                // TOOLTIP INTERACTION OPTION 2
        //         .on("mouseover", function(d) {		
        //     div.transition()		
        //         .duration(200)		
        //         .style("opacity", .9);		
        //     div	.html("the value of this cell is:" + "<br/>"  + +d.killerMike)	
        //         .style("left", (d3.event.pageX) + "px")		
        //         .style("top", (d3.event.pageY - 28) + "px");	
        //     })					
        // .on("mouseout", function(d) {		
        //     div.transition()		
        //         .duration(500)		
        //         .style("opacity", 0);	
        // });

          }
        }


})




    </script>
    
</body>
</html>


</script>